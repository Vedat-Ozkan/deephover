!function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=12)}({12:function(t,e,n){"use strict";let a;var o={},r={useTooltip:"true",translateSource:"auto",translateTarget:"En",tooltipFontSize:"14",tooltipWidth:"200"},s={auto:"auto-detect",af:"af",am:"am",ar:"ar",az:"az",bg:"bg",bs:"bs",ca:"ca",cs:"cs",cy:"cy",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fr:"fr",ga:"ga",gu:"gu",hi:"hi",hmn:"mww",hr:"hr",ht:"ht",hu:"hu",hy:"hy",id:"id",is:"is",it:"it",iw:"he",ja:"ja",kk:"kk",km:"km",kn:"kn",ko:"ko",ku:"ku",lo:"lo",lt:"lt",lv:"lv",mg:"mg",mi:"mi",ml:"ml",mr:"mr",ms:"ms",mt:"mt",my:"my",ne:"ne",nl:"nl",no:"nb",pa:"pa",pl:"pl",ps:"ps",pt:"pt",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sm:"sm",sq:"sq",sr:"sr-Cyrl",sv:"sv",sw:"sw",ta:"ta",te:"te",th:"th",tl:"fil",tr:"tr",uk:"uk",ur:"ur",vi:"vi","zh-CN":"zh-Hans","zh-TW":"zh-Hant"};function l(t){chrome.storage.local.get(Object.keys(r),(function(e){for(const t in r)e[t]?o[t]=e[t]:o[t]=r[t];void 0!==t&&t(o)}))}async function c(t,e){return console.log(t+new URLSearchParams(e)),await fetch(t+new URLSearchParams(e),{method:"POST"}).then(t=>t.json()).catch(t=>console.log(t))}chrome.runtime.onMessage.addListener((function(t,e,n){return(async()=>{"translate"===t.type?async function(t,e){const{token:n,key:r,IG:l,IID:i}=await async function(){try{if(!a||Date.now()-a.tokenTs>a.tokenExpiryInterval){const t=await fetch("https://www.bing.com/translator").then(t=>t.text()),e=t.match(/IG:"([^"]+)"/)[1],n=t.match(/data-iid="([^"]+)"/)[1],[o,r,s,l,c]=JSON.parse(t.match(/params_RichTranslateHelper\s?=\s?([^\]]+\])/)[1]);a={IG:e,IID:n,key:o,token:r,tokenTs:o,tokenExpiryInterval:s,isAuthv2:void 0,count:0}}return a}catch(t){console.log(t)}}();var u="",f="",g={auth_key:"0db9a932-1ba0-2744-698a-7cc72f9665b3:fx",text:t.word,source_lang:o.translateSource,target_lang:t.translateTarget,split_sentences:0},m="";let p=await c("https://www.bing.com/ttranslatev3?isVertical=1&&",{text:t.word,fromLang:s[o.translateSource.toLowerCase()],to:s[t.translateTarget.toLowerCase()],token:n,key:r,IG:l,IID:i&&i.length?i+"."+a.count++:""});console.log(p),p&&(m=p[0].detectedLanguage.language);if(m===g.source_lang.toLowerCase()||""===g.source_lang){console.log(g);const t=await c("https://api-free.deepl.com/v2/translate?",g);console.log(t),t?(t.translations&&(f+=t.translations[0].text),u=t.translations[0].detected_source_language,e({translatedText:f,lang:u})):e({translatedText:"",lang:"en"})}}(t,n):"saveSetting"===t.type?chrome.storage.local.set(t.options,(function(){o=t.options})):"loadSetting"===t.type&&l(n)})(),!0})),l()}});
//# sourceMappingURL=background.js.map